
# Домашнее задание к занятию "`Репликация и масштабирование. Часть 2`" - `Нижегородов Сергей`


### Задание 1
Опишите основные преимущества использования масштабирования методами:

**1. Активный master-сервер и пассивный репликационный slave-сервер:**

По своему опыту настройки в прошлом задании понял, что это как иметь запасного игрока в команде. Основные плюсы:
- **Надежность:** если мастер "упал", можно быстро переключиться на слейв
- **Чтение без нагрузки:** все сложные запросы на чтение можно отправлять на слейв, разгружая мастер
- **Резервное копирование:** можно делать бэкапы со слейва, не мешая основной работе
- **Простота:** настроить такой вариант проще, чем более сложные схемы

**2. Master-сервер и несколько slave-серверов:**

Это уже как распределить работу между несколькими сотрудниками:
- **Масштабирование чтения:** чем больше слейвов, тем больше запросов на чтение можно обработать
- **Геораспределение:** можно разместить слейвы в разных регионах для уменьшения задержек
- **Отказоустойчивость:** если один слейв сломался, остальные продолжают работать
- **Разделение по типам запросов:** можно направлять аналитические запросы на одни слейвы, а оперативные - на другие

### Задание 2
Разработайте план для выполнения горизонтального и вертикального шаринга базы данных.

**Вертикальный шаринг:**
- Разделяем таблицы по функциональности
- **Сервер 1:** `пользователи` - критически важные данные, частые обновления
- **Сервер 2:** `книги` + `магазины` - данные каталога, в основном чтение

**Горизонтальный шаринг:**
- Разделяем данные внутри таблиц по ключам

**Пользователи** (делим по хэшу email):
- Шард 1: пользователи A-M
- Шард 2: пользователи N-Z

**Книги** (делим по жанрам):
- Шард 1: художественная литература
- Шард 2: техническая литература

**Магазины** (делим по регионам):
- Шард 1: Европа
- Шард 2: Азия/Америка

**Блок-схема системы:**
┌─────────────────────────────────────────┐
│ РОУТЕР ЗАПРОСОВ                         │
└────┬──────────────────┬───────────┬─────┘
     │                  │           │
┌────┴────────┐    ┌────┴────┐ ┌────┴────┐
│ПОЛЬЗОВАТЕЛИ │    │ КНИГИ   │ │ МАГАЗИНЫ│
└────┬────────┘    └────┬────┘ └────┬────┘
     │                  │           │
   ┌─┴─────┐      ┌─────┴┐      ┌───┴──┐
┌──┴──┐ ┌──┴──┐┌──┴──┐┌──┴──┐┌──┴──┐┌──┴──┐
│Шард1│ │Шард2││Шард1││Шард2││Шард1││Шард2│
│ A-M │ │ N-Z ││Худ. ││Тех. ││Европ││Азия │
└─────┘ └─────┘└─────┘└─────┘└─────┘└─────┘

**Режимы работы:**
- Все сервера работают как Master для своих шардов
- Можно добавить Slave-реплики для каждого шарда для отказоустойчивости
- Роутер определяет куда направлять запросы на основе ключей шардирования

**Преимущества подхода:**
- Равномерное распределение нагрузки
- Простое масштабирование (можно добавлять новые шарды)
- Отказоустойчивость (падение одного шарда не затрагивает другие)

**Принципы построения:**
- Каждый шард независим и содержит только свою часть данных
- Роутер знает правила распределения данных по шардам
- Для JOIN-запросов между шардами используется специальный middleware